j\1/. "sudo lynis audit system" - НАЧНЁТ ПРОВЕРКУ СИСТЕМЫ НА БЕЗОПАСТНОСТЬ, УКАЖЕТ ЧТО ДЕЛАТЬ, ДАЛЕЕ РЕШЁННЫЕ ПРОБЛЕМЫ БЕЗОПАСНОСТИ (ПОСЛЕ ВВОДА КОМАНДЫ В СПИСКЕ "Lynis 3.0.9 Results" ВНИЗУ):
	1) "sudo lynis show details TEST-ID" - ПОКАЖЕТ ИНФОРМАЦИЮ О ТЕСТЕ;
	2) "/usr/share/lynis/include/" - ПУТЬ К ИСХОДНОМУ КОДУ ТЕСТОВ.

<<<<<<<<<<<<<<<<<<<<<<НЕ ОБЯЗАТЕЛЬНО(ПО ВЫБОРУ):>>>>>>>>>>>>>>>>>>>>>>>>>

1. "LYNIS" - ГОВОРИТ О ТОМ, ЧТО ВЕРСИЯ LYNIS НЕ САМАЯ ПОСЛЕДНЯЯ, ПРЕДЛАГАЕТ ОБНОВИТЬ НА ОФ. САЙТЕ, НЕ НАДО;
 
2. ПОДПИСЬ "BOOT"
	1) "BOOT-5122" - ЛЮБОЙ, ИМЕЮЩИЙ ФИЗИЧЕСКИЙ ДОСТУП К МАШИНЕ МОЖЕТ ЗАПУСТИТЬ ПО НА ЭТАПЕ ЗАГРУЗКИ, НУЖНО НАСТРОИТЬ ПАРОЛЬ НА GRUB:
		1.1) "grub-mkpasswd-pbkdf2" - СОЗДАСТ ПАРОЛЬ И HASH К НЕМУ;
		1.2) СОХРАНЯЕМ HASH В БУФЕР ОБМЕНА CTRL+SHIFT+C;
		1.3) "sudo nano /etc/grub.d/00_header" - ДОБАВИМ В САМЫЙ КОНЕЦ 	ФАЙЛА, ЧЕРЕЗ ПРОБЕЛ ОТ ОСТАЛЬНОГО, СЛЕДУЮЩИЕ СТРОКИ:
		cat << EOF
		set superusers="USER_NAME"
		password_pbkdf2 USER_NAME HASH
		EOF
 		1.4) "sudo grub-mkconfig" - ОБНОВИТ КОНФИГ GRUB.
	2) "BOOT-5264" - ГОВОРИТ ЧТО НАДО ПОЗАБОТИТЬСЯ О БЕЗОПАСНОСТИ СЛУЖБ:
		2.1) "systemd-analyze security" - ПОКАЖЕТ СЛУЖБЫ И УРОВЕНЬ БЕЗОПАСТНОСТИ ЭТИХ СЛУЖБ;
		2.2) ДАЛЕЕ "sudo nano /usr/lib/systemd/system/name_service" ;
		2.3) НАПРИМЕР:
		"sudo nano /usr/lib/systemd/system/auditd.service", ВНУТРИ ФАЙЛА ПОСЛЕ СТРОКИ "[Service]"  БУДЕМ ВСТАВЛЯТЬ СВОИ ПРАВИЛА СЕРВИСА, УЛУЧШАЮЩИЕ БЕЗОПАСНОСТЬ;
		2.4) ОТКРОЕМ WIN+D "code" И ОТКРОЕМ ПАПКУ "/home/user/Downloads/archlinux.../LYNIS/BOOT-5264", ГДЕ УЖЕ ЕСТЬ ГОТОВЫЕ НАСТРОЙКИ;
		2.5) СКОПИРУЕМ НУЖНЫЕ НАСТРОЙКИ СОГЛАСНО ФАЙЛАМ "SETTINGS" И "RULES" В "[Service]";
		2.6) "sudo systemctl daemon-reload" - ПЕРЕЗАПУСТИТ СЕРВИСЫ, ЗАНОВО СЧИТЫВАЯ КОНФИГ ФАЙЛ;
		2.7) "sudo systemctl start auditd" - ПРИМЕНИТ ОБНОВЛЕНИЯ, В ОСНОВНОМ ВМЕСТО "enable" НЕОБХОДИМО ПРИНИМАТЬ "restart", НО ТУТ ЭТО ИСКЛЮЧЕНИЕ;
		2.8) "sudo systemctl status auditd" - ПРОВЕРЯЕМ СТАТУС, ЧТО СЕРВИС РАБОТАЕТ КОРЕККТНО.
		3.9) ТО ЖЕ САМОЕ СДЕЛАЕМ И ДЛЯ ДРУГИХ СЕРВИСОВ;
		3.10) ЕСЛИ ЧТО-ТО ПОШЛО НЕ ТАК, СЕРВИСЫ НЕ ГРУЗЯТСЯ:
			3.10.1) "sudo reboot", НАВЕДЁМ НА ЗАПУСК "ARCH LINUX" И НАЖМЁМ "Е", ВОЙДЯ В ЗАГРУЗКУ GRUB;
			3.10.2) НАЙДЕМ СТРОКУ "LINUX ... root=... loglevel..." ;
			3.10.3) УБЕРЕМ  ВСЁ ЧТО ДАЛЬШЕ "rw" И ЗАМЕНИМ НА "init=/bin/bash";
			3.10.4) CTRL + X - ЗАПУСТИТ ARCH В ОДНОПОЛЬЗОВАТЕЛЬСКОМ РЕЖИМЕ;
			3.10.5) "reboot -f" - ВЫЙДЕТ ИЗ НЕГО И ЗАПУСТИТ GRUB.

4. "KRNL-5820" - ГОВОРИТ О БАЗОВЫХ ДАМПОВ, ХРАНЯЩИХ ИНФОРМАЦИЮ О СБОЕ КОНКРЕТНОГО ПРОГРАММНОГО КОМПОНЕНТА( КОНДИФИЦИАЛЬНЫЕ ДАННЫЕ, КОТОРЫЕ В НОРМАЛЬНЫХ УСЛОВИЯХ(РАБОЧЕЙ СИСТЕМЕ) ЛУЧШЕ ОТКЛЮЧИТЬ):
	1) "sudo nano /etc/systemd/coredump.conf" - ОТКРОЕМ ФАЙЛ;
	2) "Storage=none" "ProcessSizeMax=0" - ПОМЕНЯЕМ ЗНАЧЕНИЯ(ОТКЛЮЧИТ СОХРАНЕНИЕ ДАМПОВ);
	3) "sudo nano /etc/profile" - ОТКРОЕМ ФАЙЛ;
	4) "ulimit -c 0" ДОБАВИМ В КОНЕЦ ФАЙЛА(ПРИ ЗАПУСКЕ КОМАНДА УСТАНОВИТ МАКСИМАЛЬНЫЙ РАЗМЕР ДАМПА В 0, ОТКЛЮЧИТ ЕГО);
	5) "sudo nano /etc/security/limits.conf" - ОТКРОЕМ ФАЙЛ;
	6) "*	hard	core	0" "*	soft	core	0" - ПОМЕНЯЕМ/ДОБАВИМ ЗНАЧЕНИЯ(ОГРАНИЧЕНИЕ РАЗМЕРА ДАМПОВ ДО 0 ДЛЯ ВСЕХ ПОЛЬЗОВАТЕЛЕЙ КАК НА МЯГКОМ, ТАК И НА ЖЕСКОМ).
	

5. ПОДПИСЬ "AUTH". АВТОРИЗАЦИЯ, РЕШАЕТСЯ В ФАЙЛЕ "sudo /etc/login.defs": 
	5.1) "AUTH-9230" - НАСТРОИТЬ РАУНДЫ ХЕШИРОВАНИЯ ПАРОЛЕЙ, БОЛЬШЕЕ КОЛИЧЕСТВО ОЗНАЧАЕТ БОЛЕЕ БЕЗОПАСНОЕ ХЕШИРОВАНИЕ, НО ЗАНИМАЕТ БОЛЬШЕ ВРЕМЕНИ:
		1) НАЙДЁМ И ИЗМЕНИМ ЗНАЧЕНИЯ:
		3) "SHA_CRYPT_MIN_ROUNDS 5000" - МИНИМУМ РАУНДОВ;
		4) "SHA_CRYPT_MAX_ROUNDS 5000" - МАКСИМУМ РАУНДОВ, ИТОГО: 5000 РАУНДОВ.
	5.2) "AUTH-9286" - МИНИМАЛЬНОЕ И МАКСИМАЛЬНОЕ ЗНАЧЕНИЕ ВОЗРАСТА ПАРОЛЯ:
		1) НАЙДЁМ И ИЗМЕНИМ ЗНАЧЕНИЯ:
		2) "PASS_MAX_DAYS 90" - В ТЕЧЕНИЕ 90 ДНЕЙ ПАРОЛЬ БУДЕТ ДЕЙСТВИТЕЛЬНЫМ;
		3) "PASS_MIN_DAYS 7" - В ТЕЧЕНИЕ 7 ДНЕЙ ПОСЛЕ СОЗДАНИЯ ПАРОЛЯ ЕГО НЕЛЬЗЯ ИЗМЕНИТЬ.
	5.3) "AUTH-9328" - ЗАДАЙТЕ ПРАВА ДОСТУПА ПО УМОЛЧАНИЮ ДЛЯ ПОЛЬЗОВАТЕЛЕЙ:
		1) НАЙДЁМ И ИЗМЕНИМ ЗНАЧЕНИЯ:
		2) "UMASK	027" - ВЛАДЕЛЕЦ ФАЙЛА ИМЕЕТ ПОЛНЫЕ ПРАВА ДОСТУПА, ГРУППА ФАЙЛА ИМЕЕТ РАЗРЕШЕНИЕ НА ВЫПОЛНЕНИЕ, ОСТАЛЬНЫЕ ПОЛЬЗОВАТЕЛИ НЕ ИМЕЮТ ДОСТУПА К ФАЙЛУ(СТАВИТЬ В ПОСЛЕДНЮЮ ОЧЕРЕДЬ ИЛИ НЕ СТАВИТЬ ВООБЩЕ).
	5.4) "AUTH-9282" - ПО ВОЗМОЖНОСТИ УСТАНОВИТЬ ЗНАЧЕНИЕ ВОЗРАСТА ДЛЯ ВСЕХ ПАРОЛЕЙ:
		1) "sudo chage -M 90 user" "sudo chage -M 90 root" - УСТАНОВИТ СРОК ДЕЙСТВИЯ НА ПАРОЛИ.
	5.5) "AUTH-9262" - НУЖНО СКАЧАТЬ PAM ДЛЯ ПРОВЕРКИ СИЛЫ ПАРОЛЯ:
		1) "sudo pacman -S pam" - СКАЧАЕМ PAM;
		2) "sudo libpwquality" - ПОМОГАЕТ НАСТРОИТЬ ПОЛИТИКИ ПАРОЛЕЙ;
		3) "sudo nano /etc/pam.d/passwd" - ДОБАВИМ В ФАЙЛ НАШИ НАСТРОЙКИ, КОТОРЫЕ БУДЕМ БРАТЬ ОТСЮДА https://wiki.archlinux.org/title/Security ПУНКТ 2.4 (ЕСТЬ РУССКИЙ);
		4) ТАМ ЖЕ МОЖНО ИСПОЛЬЗОВАТЬ ДРУГОЙ МЕТОД ХЕШИРОВАНИЯ, ЛУЧШЕ УБРАТЬ;
		5) "sudo passwd USER" - ПОМЕНЯТЬ ПАРОЛЬ И "sudo reboot", чтобы вступило в действие. 
	5.6) "AUTH-9288" - ИСТЕЧЕНИЕ СРОКА ДЕЙСТВИЯ ПАРОЛЯ ПОЛЬЗОВАТЕЛЯ:
		1) "sudo passwd -S USER" - УКАЖЕТ СРОК ДЕЙСТВИЯ И ДРУГУЮ ИНФОРМАЦИЮ О ПАРОЛЕ ПОЛЬЗОВАТЕЛЯ;
		2) ЕСЛИ НАДО ПОМЕНЯТЬ ДОЛЖНА СРАЗУ ЭТО ПРЕДЛОЖИТЬ.

6. "FILE-6310" - ПРЕДЛАГАЕТ СОЗДАТЬ ОТДЕЛЬНЫЙ РАЗДЕЛ ДИСКА ДЛЯ /VAR, ЧТОБЫ УМЕНЬШИТЬ ВЛИЯНИЕ ПОЛНОЙ ФАЙЛОВОЙ СИСТЕМЫ(ПРОПУСТИМ):
	1) https://wiki.archlinux.org/title/Partitioning_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)

7.  "USB-1000" - НАДО ОТКЛЮЧИТЬ ПОДКЛЮЧЕНИЕ УСТРОЙСТВ USB:
	1) "sudo nano /etc/modprobe.d/blacklist.conf" - СОЗДАДИМ И ДОБАВИМ:
	blacklist usb-storage;
	2) "sudo reboot" - ЧТОБЫ ВСТУПИЛО В ДЕЙСТВИЕ.

8. "STRG-1846" - НУЖНО ОТКЛЮЧИТЬ FIREWILL(ИСПОЛЬЗУЕТСЯ ДЛЯ ПЕРЕДАЧИ ДАННЫХ ЧЕРЕЗ СЕТЕВОЙ КАБЕЛЬ И Т.Д.) КОГДА НЕ ИСПОЛЬЗУЕТСЯ, ПРЕДОТВРАЩЕНИЕ КРАЖИ ДАННЫХ:
	1) "sudo nano /etc/modprobe.d/blacklist.conf" - ОТКРОЕМ ФАЙЛ И ДОБАВИМ:
	blacklist ohci1394;
	2) "sudo reboot" - ЧТОБЫ ВСТУПИЛО В ДЕЙСТВИЕ.

9. "NAME-4404" - НУЖНО ДОБАВИТЬ ПОЛНОЕ ДОМЕННОЕ ИМЯ:
	1) "sudo nano /etc/hosts" - ДОБАВИМ/ИЗМЕНИМ:
	127.0.0.1 localhost
	127.0.1.1 USER.org .

10. ТИП "PKGS"
	10.1) "PKGS-7312" - ПРОСИТ ОБНОВИТЬ ПАКЕТЫ:
		1) "sudo pacman -Syu".
	10.2) "PKGS-7320" - ПРОСИТ УСТАНОВИТЬ ARCH-AUDIT:
		2) "sudo pacman -Sy arch-audit".

11. "NETW-3200" - ОПРЕДЕЛИТЬ КАКИЕ СЕТЕВЫЕ ПРОТОКОЛЫ НУЖНЫ В ЭТОЙ СИСТЕМЕ:
	1) "sudo nano /etc/modprobe.d/blacklist" - ЗАЙДЕМ В ФАЙЛ И ДОБАВИМ СЛЕДУЮЩЕЕ:
	install PROTOCOL /bin/true;
	2) О ПРОТОКОЛАХ МОЖНО ПОЧИТАТЬ В ИНТЕРНЕТЕ.

12. ТИП "LOGG":
	12.1) "LOGG-2154" - ТРЕБУЕТ ВКЛЮЧИТЬ ВЕДЕНИЕ ЖУРНАЛА НА ВНЕШНЕМ ХОСТЕ ДЛЯ АРХИВИРОАНИЯ И ДОП. ЗАЩИТЫ:
		1) "sudo pacman -S syslog-ng" - РЕАЛИЗАЦИЯ СИСТЕМНОГО ЖУРНАЛА;
		2) "sudo systemctl enable syslog-ng@default.service" - ВКЛЮЧЕНИЕ СЕРВИСА;
		3) "sudo reboot".
	12.2) "LOGG-2190" - ОПРЕДЕЛЯЕТ КАКИЕ ФАЙЛЫ УДАЛЕНЫ, НО ПРИ ЭТОМ ИСПОЛЬЗУЮТСЯ ПРОЦЕССАМИ(НЕ ПОНЯЛ)

13. "BANN-7126" - НУЖНО ДОБАВИТЬ БАННЕР, ЧТО БУДЕТ ПОЯВЛЯТЬСЯ ДЛЯ НЕАВТОРИЗОВАННЫХ ПОЛЬЗОВАТЕЛЕЙ:
	1) "sudo nano /etc/issue" - ОТКРОЕМ ФАЙЛ И ВПИШЕТ, НАПРИМЕР СЛЕДУЮЩЕЕ:
	Arch Linux используется для частного использования;
	2) "sudo cat /etc/issue" - ПРОВЕРИМ НОРМАЛЬНО ЛИ ВЫВОДИТ;
	3) ТЕСТ БУДЕТ ПОЯВЛЯТЬСЯ, ПОСКОЛЬКУ ОН НАСТРОЕН НА ENGLISH КЛЮЧИ(СЛОВА В БАННЕРЕ, КАК НАЙТИ: /usr/share/lynis/include/tests_banners -> СТРОКА "LEGAL_BANNER_STRINGS").

14. ТИП "ACCT" - СБОР ИНФОРМАЦИИ:
	14.1) "ACCT-9622" - ТРЕБУЕТ УСТАНОВИТЬ ACCT(ХРАНЕНИЕ УЧЕТНЫХ ДАННЫХ ПОЛЬЗОВАТЕЛЯ):
		1) "sudo pacman -S acct" - УСТАНОВИТЬ ACCT;
		2) "sudo systemctl enable acct" И "sudo systemctl start acct" - ВКЛЮЧИМ В СПИСОК ЗАГРУЗОК И САМУ СЛУЖБУ.
	14.2) "ACCT-9626" - ТРЕБУЕТ УСТАНОВИТЬ SYSSTAT(СОБИРАЕТ СТАТИСТИКУ):
		1) "sudo pacman -S sysstat" - УСТАНОВИТЬ SYSSTAT;
		2) "sudo systemctl enable sysstat" И "sudo systemctl start sysstat" - ВКЛЮЧИМ В СПИСОК ЗАГРУЗОК И САМУ СЛУЖБУ.
	14.3) "ACCT-9628" - ТРЕБУЕТ ВКЛЮЧИТЬ AUDITD:
		1) "sudo pacman -S auditd" - УСТАНОВИТЬ AUDITD;
		2) "sudo systemctl enable auditd" И "sudo systemctl start auditd" - ВКЛЮЧИМ В СПИСОК ЗАГРУЗОК И САМУ СЛУЖБУ.
	14.4) "ACCT-9630" - AUDITD ВКЛЮЧЕН С ПУСТЫМИ ПРАВИЛАМИ, ОТКЛЮЧИТЕ ИЛИ ДОБАВЬТЕ ПРАВИЛА:
		1) "sudo systemctl stop auditd" И "sudo systemctl disable auditd" - ОТКЛЮЧЕНИЕ AUDITD;
		2) ИЛИ НАСТРОИТЬ ПРАВИЛА АУДИТА ПО ПУТИ "/etc/audit/audit.rules".

15. "CRYPT-7902" - ПРОВЕРИТ ДОСТУПНЫЕ СЕРТИФИКАТЫ НА СРОК ДЕЙСТВИЯ(НЕ ПОНЯЛ)

16. "FINT-4350" - ТРЕБУЕТ УСТАНОВИТЬ ИНСТРУМЕНТ ДЛЯ ПРОВЕРКИ ЦЕЛОСТНОСТИ ФАЙЛОВ ДЛЯ ОТСЛЕЖИВАНИЯ ИЗМЕНЕНИЙ В КРИТИЧЕСКИХ И ВАЖНЫХ ФАЙЛАХ:
	1) "yay -S afick" - AFICK ОТСЛЕЖИВАЕТ ИЗМЕНЕНИЯ В ФАЙЛОВОЙ СИСТЕМЕ, ПОМОГАЕТ ОБНАРУЖИТЬ СЛУЧАИ ПРОНИКНОВЕНИЯ.

17. "TOOL-5002" - ТРЕБУЕТ УСТАНОВИТЬ СРЕДСТВА ОПТИМИЗАЦИИ СИСТЕМЫ:
	1) "sudo pacman -S ansible ansible-core" - УСТАНОВИТ ANSIBLE(ИНСТРУМЕНТ ДЛЯ УПРАВЛЕНИЯ АВТОМАТИЗАЦИЕЙ И КОНФИГУРАЦИЕЙ).
	

18. "KRNL-6000" - УКАЗЫВАЕТ НА ТО, ЧТО ЗНАЧЕНИЯ НЕКОТОРЫХ ПАРАМЕТРОВ ЯДРА НЕ СООТВЕТСТВУЮТ ПАРАМЕТРАМ БЕЗОПАСТНОСТИ LYNIS(ПРОПУСКАЕМ, Т.К. ЯДРО У НАС СТОИТ НЕ ПО УМОЛЧАНИЮ).

19. ТИП "HRDN":
	19.1) "HRDN-7222" - ТРЕБУЕТ УВЕЛИЧИТЬ УРОВЕНЬ ДОСТУПА К ФАЙЛАМ(КОМПИЛЯТОРАМ):
		1) "sudo chmod 750 /path" - И НАЙТИ ПУТИ ПРИ ПОМОЩИ КОМАНДЫ "sudo lynis show details HRDN-7222".
	19.2) "HRDN-7230" - ТРЕБУЕТ УСТАНОВИТЬ ХОТЯБЫ ОДИН СКАНЕР ВРЕДОНОСНЫХ ПРОГРАММ ДЛЯ ПЕРЕОДИЧЕСКОГО СКАНИРОВАНИЯ:
		1) "sudo pacman -S rkhunter" - СКАНЕР ВРЕДОНОСНЫХ ПРОГРАММ;
		2) "sudo nano /etc/rkhunter.conf" - КОНФИГ;
		3) "sudo rkhunter --check" - ЗАПУСТИТ СКАНИРОВАНИЕ.



